#include "Tersoff_inc_surf.h"

#include <math.h>

static double z[245];

/* calculate the surface strain energy density */
double get_energy_surf(const double* params, const double *Xsi, const double *Xa, const double *Ya, const double *Za, const double* Cmat) {

/* common definitions */
#include "Tersoff_common_defines_surf.h"

	z[1] = c*c;
	z[2] = 1./(d*d);
	z[3] = d*d;
	z[4] = 1./n;
	z[5] = -X1;
	z[6] = -X2;
	z[7] = -X6;
	z[8] = -X7;
	z[9] = -X8;
	z[10] = -X9;
	z[11] = -Xs1;
	z[12] = -Y1;
	z[13] = -Y2;
	z[14] = -Y6;
	z[15] = -Y7;
	z[16] = -Y8;
	z[17] = -Y9;
	z[18] = -Ys1;
	z[19] = -Z1;
	z[20] = -Z2;
	z[21] = -Z6;
	z[22] = -Z7;
	z[23] = -Z8;
	z[24] = -Z9;
	z[25] = -Zs1;
	z[26] = X1 + z[10];
	z[27] = X7 + z[10];
	z[28] = X8 + z[10];
	z[10] = X6 + z[10] + z[11];
	z[29] = Y7 + z[12];
	z[30] = Y8 + z[12];
	z[31] = Y9 + z[12];
	z[32] = Y6 + z[13];
	z[13] = Y1 + Ys1 + z[13];
	z[33] = Y2 + z[14];
	z[14] = Y1 + Ys1 + z[14];
	z[34] = Y1 + z[15];
	z[35] = Y8 + z[15];
	z[36] = Y9 + z[15];
	z[37] = Y1 + z[16];
	z[38] = Y7 + z[16];
	z[39] = Y9 + z[16];
	z[40] = Y1 + z[17];
	z[41] = Y7 + z[17];
	z[42] = Y8 + z[17];
	z[12] = Y6 + z[12] + z[18];
	z[15] = Y6 + z[15] + z[18];
	z[16] = Y6 + z[16] + z[18];
	z[17] = Y6 + z[17] + z[18];
	z[2] = z[1]*z[2];
	z[18] = Z2 + z[21];
	z[43] = Z1 + z[22];
	z[44] = Z1 + z[23];
	z[45] = Z1 + z[24];
	z[4] = -0.5*z[4];
	z[46] = X7 + z[5];
	z[47] = X8 + z[5];
	z[48] = X9 + z[5];
	z[5] = X6 + z[11] + z[5];
	z[49] = X6 + z[6];
	z[6] = X1 + Xs1 + z[6];
	z[50] = z[20] + Z6;
	z[51] = z[19] + z[25] + Z6;
	z[52] = z[22] + z[25] + Z6;
	z[53] = z[23] + z[25] + Z6;
	z[25] = z[24] + z[25] + Z6;
	z[54] = X2 + z[7];
	z[7] = X1 + Xs1 + z[7];
	z[55] = z[19] + Z7;
	z[56] = z[23] + Z7;
	z[57] = z[24] + Z7;
	z[58] = X1 + z[8];
	z[59] = X8 + z[8];
	z[60] = X9 + z[8];
	z[8] = X6 + z[11] + z[8];
	z[61] = z[19] + Z8;
	z[62] = z[22] + Z8;
	z[24] = z[24] + Z8;
	z[63] = X1 + z[9];
	z[64] = X7 + z[9];
	z[65] = X9 + z[9];
	z[9] = X6 + z[11] + z[9];
	z[11] = z[19] + Z9;
	z[19] = z[22] + Z9;
	z[22] = z[23] + Z9;
	z[20] = Z1 + z[20] + Zs1;
	z[21] = Z1 + z[21] + Zs1;
	z[23] = C11*z[26];
	z[66] = C12*z[26];
	z[67] = C13*z[26];
	z[68] = C11*z[27];
	z[69] = C12*z[27];
	z[70] = C13*z[27];
	z[71] = C11*z[28];
	z[72] = C12*z[28];
	z[73] = C13*z[28];
	z[74] = C11*z[10];
	z[75] = C12*z[10];
	z[76] = C13*z[10];
	z[77] = C21*z[29];
	z[78] = C22*z[29];
	z[79] = C23*z[29];
	z[80] = C21*z[30];
	z[81] = C22*z[30];
	z[82] = C23*z[30];
	z[83] = C21*z[31];
	z[84] = C22*z[31];
	z[85] = C23*z[31];
	z[86] = C21*z[32];
	z[87] = C22*z[32];
	z[88] = C23*z[32];
	z[89] = C21*z[13];
	z[90] = C22*z[13];
	z[91] = C23*z[13];
	z[92] = C21*z[33];
	z[93] = C22*z[33];
	z[94] = C23*z[33];
	z[95] = C21*z[14];
	z[96] = C22*z[14];
	z[97] = C23*z[14];
	z[98] = C21*z[34];
	z[99] = C22*z[34];
	z[100] = C23*z[34];
	z[101] = C21*z[35];
	z[102] = C22*z[35];
	z[103] = C23*z[35];
	z[104] = C21*z[36];
	z[105] = C22*z[36];
	z[106] = C23*z[36];
	z[107] = C21*z[37];
	z[108] = C22*z[37];
	z[109] = C23*z[37];
	z[110] = C21*z[38];
	z[111] = C22*z[38];
	z[112] = C23*z[38];
	z[113] = C21*z[39];
	z[114] = C22*z[39];
	z[115] = C23*z[39];
	z[116] = C21*z[40];
	z[117] = C22*z[40];
	z[118] = C23*z[40];
	z[119] = C21*z[41];
	z[120] = C22*z[41];
	z[121] = C23*z[41];
	z[122] = C21*z[42];
	z[123] = C22*z[42];
	z[124] = C23*z[42];
	z[125] = C21*z[12];
	z[126] = C22*z[12];
	z[127] = C23*z[12];
	z[128] = C21*z[15];
	z[129] = C22*z[15];
	z[130] = C23*z[15];
	z[131] = C21*z[16];
	z[132] = C22*z[16];
	z[133] = C23*z[16];
	z[134] = C21*z[17];
	z[135] = C22*z[17];
	z[136] = C23*z[17];
	z[137] = C31*z[18];
	z[138] = C32*z[18];
	z[139] = C33*z[18];
	z[140] = C31*z[43];
	z[141] = C32*z[43];
	z[142] = C33*z[43];
	z[143] = C31*z[44];
	z[144] = C32*z[44];
	z[145] = C33*z[44];
	z[146] = C31*z[45];
	z[147] = C32*z[45];
	z[148] = C33*z[45];
	z[149] = C11*z[46];
	z[150] = C12*z[46];
	z[151] = C13*z[46];
	z[152] = C11*z[47];
	z[153] = C12*z[47];
	z[154] = C13*z[47];
	z[155] = C11*z[48];
	z[156] = C12*z[48];
	z[157] = C13*z[48];
	z[158] = C11*z[5];
	z[159] = C12*z[5];
	z[160] = C13*z[5];
	z[161] = C11*z[49];
	z[162] = C12*z[49];
	z[163] = C13*z[49];
	z[164] = C11*z[6];
	z[165] = C12*z[6];
	z[166] = C13*z[6];
	z[167] = C31*z[50];
	z[168] = C32*z[50];
	z[169] = C33*z[50];
	z[170] = C31*z[51];
	z[171] = C32*z[51];
	z[172] = C33*z[51];
	z[173] = C31*z[52];
	z[174] = C32*z[52];
	z[175] = C33*z[52];
	z[176] = C31*z[53];
	z[177] = C32*z[53];
	z[178] = C33*z[53];
	z[179] = C31*z[25];
	z[180] = C32*z[25];
	z[181] = C33*z[25];
	z[182] = C11*z[54];
	z[183] = C12*z[54];
	z[184] = C13*z[54];
	z[185] = C11*z[7];
	z[186] = C12*z[7];
	z[187] = C13*z[7];
	z[188] = C31*z[55];
	z[189] = C32*z[55];
	z[190] = C33*z[55];
	z[191] = C31*z[56];
	z[192] = C32*z[56];
	z[193] = C33*z[56];
	z[194] = C31*z[57];
	z[195] = C32*z[57];
	z[196] = C33*z[57];
	z[197] = C11*z[58];
	z[198] = C12*z[58];
	z[199] = C13*z[58];
	z[200] = C11*z[59];
	z[201] = C12*z[59];
	z[202] = C13*z[59];
	z[203] = C11*z[60];
	z[204] = C12*z[60];
	z[205] = C13*z[60];
	z[206] = C11*z[8];
	z[207] = C12*z[8];
	z[208] = C13*z[8];
	z[209] = C31*z[61];
	z[210] = C32*z[61];
	z[211] = C33*z[61];
	z[212] = C31*z[62];
	z[213] = C32*z[62];
	z[214] = C33*z[62];
	z[215] = C31*z[24];
	z[216] = C32*z[24];
	z[217] = C33*z[24];
	z[218] = C11*z[63];
	z[219] = C12*z[63];
	z[220] = C13*z[63];
	z[221] = C11*z[64];
	z[222] = C12*z[64];
	z[223] = C13*z[64];
	z[224] = C11*z[65];
	z[225] = C12*z[65];
	z[226] = C13*z[65];
	z[227] = C11*z[9];
	z[228] = C12*z[9];
	z[229] = C13*z[9];
	z[230] = C31*z[11];
	z[231] = C32*z[11];
	z[232] = C33*z[11];
	z[233] = C31*z[19];
	z[234] = C32*z[19];
	z[235] = C33*z[19];
	z[236] = C31*z[22];
	z[237] = C32*z[22];
	z[238] = C33*z[22];
	z[239] = C31*z[20];
	z[240] = C32*z[20];
	z[241] = C33*z[20];
	z[242] = C31*z[21];
	z[243] = C32*z[21];
	z[244] = C33*z[21];
	z[86] = z[161] + z[167] + z[86];
	z[87] = z[162] + z[168] + z[87];
	z[88] = z[163] + z[169] + z[88];
	z[125] = z[125] + z[158] + z[170];
	z[126] = z[126] + z[159] + z[171];
	z[127] = z[127] + z[160] + z[172];
	z[92] = z[137] + z[182] + z[92];
	z[93] = z[138] + z[183] + z[93];
	z[94] = z[139] + z[184] + z[94];
	z[77] = z[149] + z[188] + z[77];
	z[78] = z[150] + z[189] + z[78];
	z[79] = z[151] + z[190] + z[79];
	z[98] = z[140] + z[197] + z[98];
	z[99] = z[141] + z[198] + z[99];
	z[100] = z[100] + z[142] + z[199];
	z[128] = z[128] + z[173] + z[206];
	z[129] = z[129] + z[174] + z[207];
	z[130] = z[130] + z[175] + z[208];
	z[80] = z[152] + z[209] + z[80];
	z[81] = z[153] + z[210] + z[81];
	z[82] = z[154] + z[211] + z[82];
	z[101] = z[101] + z[200] + z[212];
	z[102] = z[102] + z[201] + z[213];
	z[103] = z[103] + z[202] + z[214];
	z[107] = z[107] + z[143] + z[218];
	z[108] = z[108] + z[144] + z[219];
	z[109] = z[109] + z[145] + z[220];
	z[110] = z[110] + z[191] + z[221];
	z[111] = z[111] + z[192] + z[222];
	z[112] = z[112] + z[193] + z[223];
	z[131] = z[131] + z[176] + z[227];
	z[132] = z[132] + z[177] + z[228];
	z[133] = z[133] + z[178] + z[229];
	z[83] = z[155] + z[230] + z[83];
	z[84] = z[156] + z[231] + z[84];
	z[85] = z[157] + z[232] + z[85];
	z[104] = z[104] + z[203] + z[233];
	z[105] = z[105] + z[204] + z[234];
	z[106] = z[106] + z[205] + z[235];
	z[113] = z[113] + z[224] + z[236];
	z[114] = z[114] + z[225] + z[237];
	z[115] = z[115] + z[226] + z[238];
	z[89] = z[164] + z[239] + z[89];
	z[90] = z[165] + z[240] + z[90];
	z[91] = z[166] + z[241] + z[91];
	z[95] = z[185] + z[242] + z[95];
	z[96] = z[186] + z[243] + z[96];
	z[97] = z[187] + z[244] + z[97];
	z[23] = z[116] + z[146] + z[23];
	z[66] = z[117] + z[147] + z[66];
	z[67] = z[118] + z[148] + z[67];
	z[68] = z[119] + z[194] + z[68];
	z[69] = z[120] + z[195] + z[69];
	z[70] = z[121] + z[196] + z[70];
	z[71] = z[122] + z[215] + z[71];
	z[72] = z[123] + z[216] + z[72];
	z[73] = z[124] + z[217] + z[73];
	z[74] = z[134] + z[179] + z[74];
	z[75] = z[135] + z[180] + z[75];
	z[76] = z[136] + z[181] + z[76];
	z[29] = -z[29]*z[78];
	z[30] = -z[30]*z[81];
	z[23] = -z[23]*z[26];
	z[26] = -z[27]*z[68];
	z[27] = -z[31]*z[84];
	z[28] = -z[28]*z[71];
	z[10] = z[10]*z[74];
	z[31] = -z[32]*z[87];
	z[13] = z[13]*z[90];
	z[32] = -z[33]*z[93];
	z[14] = z[14]*z[96];
	z[33] = -z[34]*z[99];
	z[34] = -z[102]*z[35];
	z[35] = -z[105]*z[36];
	z[36] = -z[108]*z[37];
	z[37] = -z[111]*z[38];
	z[38] = -z[114]*z[39];
	z[39] = -z[40]*z[66];
	z[40] = -z[41]*z[69];
	z[41] = -z[42]*z[72];
	z[12] = z[12]*z[126];
	z[15] = z[129]*z[15];
	z[16] = z[132]*z[16];
	z[17] = z[17]*z[75];
	z[18] = -z[18]*z[94];
	z[42] = -z[100]*z[43];
	z[43] = -z[109]*z[44];
	z[44] = -z[45]*z[67];
	z[45] = -z[46]*z[77];
	z[46] = -z[47]*z[80];
	z[47] = -z[48]*z[83];
	z[5] = z[125]*z[5];
	z[48] = -z[49]*z[86];
	z[6] = z[6]*z[89];
	z[49] = -z[50]*z[88];
	z[50] = z[127]*z[51];
	z[51] = z[130]*z[52];
	z[52] = z[133]*z[53];
	z[25] = z[25]*z[76];
	z[53] = -z[54]*z[92];
	z[7] = z[7]*z[95];
	z[54] = -z[55]*z[79];
	z[55] = -z[112]*z[56];
	z[56] = -z[57]*z[70];
	z[57] = -z[58]*z[98];
	z[58] = -z[101]*z[59];
	z[59] = -z[104]*z[60];
	z[8] = z[128]*z[8];
	z[60] = -z[61]*z[82];
	z[61] = -z[103]*z[62];
	z[24] = -z[24]*z[73];
	z[62] = -z[107]*z[63];
	z[63] = -z[110]*z[64];
	z[64] = -z[113]*z[65];
	z[9] = z[131]*z[9];
	z[11] = -z[11]*z[85];
	z[19] = -z[106]*z[19];
	z[22] = -z[115]*z[22];
	z[20] = z[20]*z[91];
	z[21] = z[21]*z[97];
	z[5] = z[12] + z[5] + z[50];
	z[10] = z[10] + z[17] + z[25];
	z[8] = z[15] + z[51] + z[8];
	z[9] = z[16] + z[52] + z[9];
	z[6] = z[13] + z[20] + z[6];
	z[7] = z[14] + z[21] + z[7];
	z[12] = z[10] + z[23] + z[39] + z[44] + z[5];
	z[11] = z[10] + z[11] + z[27] + z[47] + z[5];
	z[13] = z[29] + z[45] + z[5] + z[54] + z[8];
	z[14] = z[33] + z[42] + z[5] + z[57] + z[8];
	z[15] = z[10] + z[26] + z[40] + z[56] + z[8];
	z[16] = z[10] + z[19] + z[35] + z[59] + z[8];
	z[17] = z[30] + z[46] + z[5] + z[60] + z[9];
	z[19] = z[36] + z[43] + z[5] + z[62] + z[9];
	z[20] = z[10] + z[24] + z[28] + z[41] + z[9];
	z[21] = z[10] + z[22] + z[38] + z[64] + z[9];
	z[22] = z[34] + z[58] + z[61] + z[8] + z[9];
	z[23] = z[37] + z[55] + z[63] + z[8] + z[9];
	z[24] = z[31] + z[48] + z[49] + z[6] + z[7];
	z[18] = z[18] + z[32] + z[53] + z[6] + z[7];
	z[25] = 1./sqrt(z[5]);
	z[5] = sqrt(z[5]);
	z[26] = 1./sqrt(z[10]);
	z[10] = sqrt(z[10]);
	z[27] = 1./sqrt(z[8]);
	z[8] = sqrt(z[8]);
	z[28] = 1./sqrt(z[9]);
	z[9] = sqrt(z[9]);
	z[29] = 1./sqrt(z[6]);
	z[6] = sqrt(z[6]);
	z[30] = 1./sqrt(z[7]);
	z[7] = sqrt(z[7]);
	z[5] = -z[5];
	z[12] = -0.5*z[12]*z[25]*z[26];
	z[11] = -0.5*z[11]*z[25]*z[26];
	z[31] = -lam*z[10];
	z[10] = -mu*z[10];
	z[13] = -0.5*z[13]*z[25]*z[27];
	z[14] = -0.5*z[14]*z[25]*z[27];
	z[15] = -0.5*z[15]*z[26]*z[27];
	z[16] = -0.5*z[16]*z[26]*z[27];
	z[32] = -lam*z[8];
	z[8] = -mu*z[8];
	z[17] = -0.5*z[17]*z[25]*z[28];
	z[19] = -0.5*z[19]*z[25]*z[28];
	z[20] = -0.5*z[20]*z[26]*z[28];
	z[21] = -0.5*z[21]*z[26]*z[28];
	z[22] = -0.5*z[22]*z[27]*z[28];
	z[23] = -0.5*z[23]*z[27]*z[28];
	z[25] = -lam*z[9];
	z[9] = -mu*z[9];
	z[26] = -lam*z[6];
	z[6] = -mu*z[6];
	z[24] = -0.5*z[24]*z[29]*z[30];
	z[18] = -0.5*z[18]*z[29]*z[30];
	z[27] = -lam*z[7];
	z[7] = -mu*z[7];
	z[28] = lam*z[5];
	z[5] = mu*z[5];
	z[29] = exp(z[31]);
	z[10] = exp(z[10]);
	z[30] = exp(z[32]);
	z[8] = exp(z[8]);
	z[25] = exp(z[25]);
	z[9] = exp(z[9]);
	z[26] = exp(z[26]);
	z[6] = exp(z[6]);
	z[27] = exp(z[27]);
	z[7] = exp(z[7]);
	z[28] = exp(z[28]);
	z[5] = exp(z[5]);
	z[12] = h + z[12];
	z[11] = h + z[11];
	z[13] = h + z[13];
	z[14] = h + z[14];
	z[15] = h + z[15];
	z[16] = h + z[16];
	z[17] = h + z[17];
	z[19] = h + z[19];
	z[20] = h + z[20];
	z[21] = h + z[21];
	z[22] = h + z[22];
	z[23] = h + z[23];
	z[24] = h + z[24];
	z[18] = h + z[18];
	z[29] = A*z[29];
	z[30] = A*z[30];
	z[25] = A*z[25];
	z[26] = A*z[26];
	z[27] = A*z[27];
	z[28] = A*z[28];
	z[12] = z[12]*z[12];
	z[11] = z[11]*z[11];
	z[13] = z[13]*z[13];
	z[14] = z[14]*z[14];
	z[15] = z[15]*z[15];
	z[16] = z[16]*z[16];
	z[17] = z[17]*z[17];
	z[19] = z[19]*z[19];
	z[20] = z[20]*z[20];
	z[21] = z[21]*z[21];
	z[22] = z[22]*z[22];
	z[23] = z[23]*z[23];
	z[24] = z[24]*z[24];
	z[18] = z[18]*z[18];
	z[12] = z[12] + z[3];
	z[11] = z[11] + z[3];
	z[13] = z[13] + z[3];
	z[14] = z[14] + z[3];
	z[15] = z[15] + z[3];
	z[16] = z[16] + z[3];
	z[17] = z[17] + z[3];
	z[19] = z[19] + z[3];
	z[20] = z[20] + z[3];
	z[21] = z[21] + z[3];
	z[22] = z[22] + z[3];
	z[23] = z[23] + z[3];
	z[24] = z[24] + z[3];
	z[3] = z[18] + z[3];
	z[12] = 1./z[12];
	z[11] = 1./z[11];
	z[13] = 1./z[13];
	z[14] = 1./z[14];
	z[15] = 1./z[15];
	z[16] = 1./z[16];
	z[17] = 1./z[17];
	z[18] = 1./z[19];
	z[19] = 1./z[20];
	z[20] = 1./z[21];
	z[21] = 1./z[22];
	z[22] = 1./z[23];
	z[23] = 1./z[24];
	z[3] = 1./z[3];
	z[1] = -z[1];
	z[12] = z[1]*z[12];
	z[11] = z[1]*z[11];
	z[13] = z[1]*z[13];
	z[14] = z[1]*z[14];
	z[15] = z[1]*z[15];
	z[16] = z[1]*z[16];
	z[17] = z[1]*z[17];
	z[18] = z[1]*z[18];
	z[19] = z[1]*z[19];
	z[20] = z[1]*z[20];
	z[21] = z[1]*z[21];
	z[22] = z[1]*z[22];
	z[23] = z[1]*z[23];
	z[1] = z[1]*z[3];
	z[2] = 1. + z[2];
	z[3] = z[12] + z[2];
	z[11] = z[11] + z[2];
	z[12] = z[13] + z[2];
	z[13] = z[14] + z[2];
	z[14] = z[15] + z[2];
	z[15] = z[16] + z[2];
	z[16] = z[17] + z[2];
	z[17] = z[18] + z[2];
	z[18] = z[19] + z[2];
	z[19] = z[2] + z[20];
	z[20] = z[2] + z[21];
	z[21] = z[2] + z[22];
	z[22] = z[2] + z[23];
	z[1] = z[1] + z[2];
	z[2] = beta*z[3];
	z[3] = beta*z[11];
	z[11] = beta*z[12];
	z[12] = beta*z[13];
	z[13] = beta*z[14];
	z[14] = beta*z[15];
	z[15] = beta*z[16];
	z[16] = beta*z[17];
	z[17] = beta*z[18];
	z[18] = beta*z[19];
	z[19] = beta*z[20];
	z[20] = beta*z[21];
	z[21] = beta*z[22];
	z[1] = beta*z[1];
	z[2] = z[12] + z[16] + z[2];
	z[3] = z[14] + z[18] + z[3];
	z[12] = z[15] + z[17] + z[19];
	z[11] = z[11] + z[13] + z[20];
	z[13] = pow(z[21],n);
	z[1] = pow(z[1],n);
	z[2] = pow(z[2],n);
	z[3] = pow(z[3],n);
	z[12] = pow(z[12],n);
	z[11] = pow(z[11],n);
	z[13] = 1. + z[13];
	z[1] = 1. + z[1];
	z[2] = 1. + z[2];
	z[3] = 1. + z[3];
	z[12] = 1. + z[12];
	z[11] = 1. + z[11];
	z[13] = pow(z[13],z[4]);
	z[1] = pow(z[1],z[4]);
	z[14] = -B*chi;
	z[2] = pow(z[2],z[4]);
	z[3] = pow(z[3],z[4]);
	z[12] = pow(z[12],z[4]);
	z[4] = pow(z[11],z[4]);
	z[7] = z[13]*z[14]*z[7];
	z[1] = z[1]*z[14]*z[6];
	z[2] = z[14]*z[2]*z[5];
	z[3] = z[10]*z[14]*z[3];
	z[5] = z[12]*z[14]*z[9];
	z[4] = z[14]*z[4]*z[8];
	z[1] = z[1] + z[26] + z[27] + z[7];
	z[2] = z[2] + z[25] + z[28] + z[29] + z[3] + z[30] + z[4] + z[5];
	z[1] = 0.5*z[1];
	z[2] = 0.25*z[2];
	z[1] = z[1] + z[2];

	/* output */
	return z[1];
}