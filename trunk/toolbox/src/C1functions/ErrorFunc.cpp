/* $Id: ErrorFunc.cpp,v 1.2 2002-02-06 02:27:03 paklein Exp $ */
/* created: dzeigle (10/30/1997)                                          */

#include "ErrorFunc.h"
#include <math.h>
#include <iostream.h>
#include "ExceptionCodes.h"
#include "dArrayT.h"

/*
* constructors
*/
ErrorFunc::ErrorFunc(double S): fS(S) { }

/*
* I/O
*/
void ErrorFunc::Print(ostream& out) const
{
	/* parameters */
	out << " No Scaling constant. . . . . . . . . . . . . . . ." << '\n';
}

void ErrorFunc::PrintName(ostream& out) const
{
	out << "    Error Function\n";
}

/*
* Returning values
*/
double ErrorFunc::Function(double x) const
{
	double posx, posval=0.0, val, hi=3.56, m;
	int i, N=713;
	
	posx = (x<0) ? (-x) : x;
	
	if ((fS>0) && (posx>hi))
		posval = 1.0;
	else if ((fS>0) && (posx>=0) && (posx<=hi))
	{
		static double dom[] = {0, 0.005, 0.01, 0.015, 0.02, 0.025, 0.03, 0.035, 0.04, 0.045, 0.05, 0.055, 
 0.06, 0.065, 0.07, 0.075, 0.08, 0.085, 0.09, 0.095, 0.1, 0.105, 0.11, 0.115, 
 0.12, 0.125, 0.13, 0.135, 0.14, 0.145, 0.15, 0.155, 0.16, 0.165, 0.17, 
 0.17500000000000002, 0.18, 0.185, 0.19, 0.195, 0.2, 0.20500000000000002, 
 0.21, 0.215, 0.22, 0.225, 0.23, 0.23500000000000001, 0.24, 0.245, 0.25, 
 0.255, 0.26, 0.265, 0.27, 0.275, 0.28, 0.28500000000000003, 0.29, 0.295, 
 0.3, 0.305, 0.31, 0.315, 0.32, 0.325, 0.33, 0.335, 0.34, 
 0.34500000000000003, 0.35000000000000003, 0.355, 0.36, 0.365, 0.37, 0.375, 
 0.38, 0.385, 0.39, 0.395, 0.4, 0.405, 0.41000000000000003, 
 0.41500000000000004, 0.42, 0.425, 0.43, 0.435, 0.44, 0.445, 0.45, 0.455, 
 0.46, 0.465, 0.47000000000000003, 0.47500000000000003, 0.48, 0.485, 0.49, 
 0.495, 0.5, 0.505, 0.51, 0.515, 0.52, 0.525, 0.53, 0.535, 0.54, 0.545, 0.55, 
 0.555, 0.56, 0.5650000000000001, 0.5700000000000001, 0.5750000000000001, 
 0.58, 0.585, 0.59, 0.595, 0.6, 0.605, 0.61, 0.615, 0.62, 0.625, 0.63, 0.635, 
 0.64, 0.645, 0.65, 0.655, 0.66, 0.665, 0.67, 0.675, 0.68, 0.685, 
 0.6900000000000001, 0.6950000000000001, 0.7000000000000001, 0.705, 0.71, 
 0.715, 0.72, 0.725, 0.73, 0.735, 0.74, 0.745, 0.75, 0.755, 0.76, 0.765, 
 0.77, 0.775, 0.78, 0.785, 0.79, 0.795, 0.8, 0.805, 0.81, 0.8150000000000001, 
 0.8200000000000001, 0.8250000000000001, 0.8300000000000001, 0.835, 0.84, 
 0.845, 0.85, 0.855, 0.86, 0.865, 0.87, 0.875, 0.88, 0.885, 0.89, 0.895, 0.9, 
 0.905, 0.91, 0.915, 0.92, 0.925, 0.93, 0.935, 0.9400000000000001, 
 0.9450000000000001, 0.9500000000000001, 0.9550000000000001, 0.96, 0.965, 
 0.97, 0.975, 0.98, 0.985, 0.99, 0.995, 1., 1.0050000000000001, 1.01, 
 1.0150000000000001, 1.02, 1.025, 1.03, 1.035, 1.04, 1.045, 1.05, 1.055, 
 1.06, 1.065, 1.07, 1.075, 1.08, 1.085, 1.09, 1.095, 1.1, 1.105, 1.11, 1.115, 
 1.12, 1.125, 1.1300000000000001, 1.135, 1.1400000000000001, 1.145, 
 1.1500000000000001, 1.155, 1.16, 1.165, 1.17, 1.175, 1.18, 1.185, 1.19, 
 1.195, 1.2, 1.205, 1.21, 1.215, 1.22, 1.225, 1.23, 1.235, 1.24, 1.245, 1.25, 
 1.2550000000000001, 1.26, 1.2650000000000001, 1.27, 1.2750000000000001, 
 1.28, 1.285, 1.29, 1.295, 1.3, 1.305, 1.31, 1.315, 1.32, 1.325, 1.33, 1.335, 
 1.34, 1.345, 1.35, 1.355, 1.36, 1.365, 1.37, 1.375, 1.3800000000000001, 
 1.385, 1.3900000000000001, 1.395, 1.4000000000000001, 1.405, 1.41, 1.415, 
 1.42, 1.425, 1.43, 1.435, 1.44, 1.445, 1.45, 1.455, 1.46, 1.465, 1.47, 
 1.475, 1.48, 1.485, 1.49, 1.495, 1.5, 1.5050000000000001, 1.51, 
 1.5150000000000001, 1.52, 1.5250000000000001, 1.53, 1.5350000000000001, 
 1.54, 1.545, 1.55, 1.555, 1.56, 1.565, 1.57, 1.575, 1.58, 1.585, 1.59, 
 1.595, 1.6, 1.605, 1.61, 1.615, 1.62, 1.625, 1.6300000000000001, 1.635, 
 1.6400000000000001, 1.645, 1.6500000000000001, 1.655, 1.6600000000000001, 
 1.665, 1.67, 1.675, 1.68, 1.685, 1.69, 1.695, 1.7, 1.705, 1.71, 1.715, 1.72, 
 1.725, 1.73, 1.735, 1.74, 1.745, 1.75, 1.7550000000000001, 1.76, 
 1.7650000000000001, 1.77, 1.7750000000000001, 1.78, 1.7850000000000001, 
 1.79, 1.795, 1.8, 1.805, 1.81, 1.815, 1.82, 1.825, 1.83, 1.835, 1.84, 1.845, 
 1.85, 1.855, 1.86, 1.865, 1.87, 1.875, 1.8800000000000001, 1.885, 
 1.8900000000000001, 1.895, 1.9000000000000001, 1.905, 1.9100000000000001, 
 1.915, 1.92, 1.925, 1.93, 1.935, 1.94, 1.945, 1.95, 1.955, 1.96, 1.965, 
 1.97, 1.975, 1.98, 1.985, 1.99, 1.995, 2., 2.005, 2.0100000000000002, 2.015, 
 2.02, 2.025, 2.0300000000000002, 2.035, 2.04, 2.045, 2.05, 2.055, 2.06, 
 2.065, 2.07, 2.075, 2.08, 2.085, 2.09, 2.095, 2.1, 2.105, 2.11, 2.115, 2.12, 
 2.125, 2.13, 2.1350000000000002, 2.14, 2.145, 2.15, 2.1550000000000002, 
 2.16, 2.165, 2.17, 2.1750000000000003, 2.18, 2.185, 2.19, 2.195, 2.2, 2.205, 
 2.21, 2.215, 2.22, 2.225, 2.23, 2.235, 2.24, 2.245, 2.25, 2.255, 
 2.2600000000000002, 2.265, 2.27, 2.275, 2.2800000000000002, 2.285, 2.29, 
 2.295, 2.3000000000000003, 2.305, 2.31, 2.315, 2.32, 2.325, 2.33, 2.335, 
 2.34, 2.345, 2.35, 2.355, 2.36, 2.365, 2.37, 2.375, 2.38, 
 2.3850000000000002, 2.39, 2.395, 2.4, 2.4050000000000002, 2.41, 2.415, 2.42, 
 2.4250000000000003, 2.43, 2.435, 2.44, 2.445, 2.45, 2.455, 2.46, 2.465, 
 2.47, 2.475, 2.48, 2.485, 2.49, 2.495, 2.5, 2.505, 2.5100000000000002, 
 2.515, 2.52, 2.525, 2.5300000000000002, 2.535, 2.54, 2.545, 
 2.5500000000000003, 2.555, 2.56, 2.565, 2.57, 2.575, 2.58, 2.585, 2.59, 
 2.595, 2.6, 2.605, 2.61, 2.615, 2.62, 2.625, 2.63, 2.6350000000000002, 2.64, 
 2.645, 2.65, 2.6550000000000002, 2.66, 2.665, 2.67, 2.6750000000000003, 
 2.68, 2.685, 2.69, 2.695, 2.7, 2.705, 2.71, 2.715, 2.72, 2.725, 2.73, 2.735, 
 2.74, 2.745, 2.75, 2.755, 2.7600000000000002, 2.765, 2.77, 2.775, 
 2.7800000000000002, 2.785, 2.79, 2.795, 2.8000000000000003, 2.805, 2.81, 
 2.815, 2.82, 2.825, 2.83, 2.835, 2.84, 2.845, 2.85, 2.855, 2.86, 2.865, 
 2.87, 2.875, 2.88, 2.8850000000000002, 2.89, 2.895, 2.9, 2.9050000000000002, 
 2.91, 2.915, 2.92, 2.9250000000000003, 2.93, 2.935, 2.94, 2.945, 2.95, 
 2.955, 2.96, 2.965, 2.97, 2.975, 2.98, 2.985, 2.99, 2.995, 3., 3.005, 
 3.0100000000000002, 3.015, 3.02, 3.025, 3.0300000000000002, 3.035, 3.04, 
 3.045, 3.0500000000000003, 3.055, 3.06, 3.065, 3.0700000000000003, 3.075, 
 3.08, 3.085, 3.09, 3.095, 3.1, 3.105, 3.11, 3.115, 3.12, 3.125, 3.13, 
 3.1350000000000002, 3.14, 3.145, 3.15, 3.1550000000000002, 3.16, 3.165, 
 3.17, 3.1750000000000003, 3.18, 3.185, 3.19, 3.1950000000000003, 3.2, 3.205, 
 3.21, 3.215, 3.22, 3.225, 3.23, 3.235, 3.24, 3.245, 3.25, 3.255, 
 3.2600000000000002, 3.265, 3.27, 3.275, 3.2800000000000002, 3.285, 3.29, 
 3.295, 3.3000000000000003, 3.305, 3.31, 3.315, 3.3200000000000003, 3.325, 
 3.33, 3.335, 3.34, 3.345, 3.35, 3.355, 3.36, 3.365, 3.37, 3.375, 3.38, 
 3.3850000000000002, 3.39, 3.395, 3.4, 3.4050000000000002, 3.41, 3.415, 3.42, 
 3.4250000000000003, 3.43, 3.435, 3.44, 3.4450000000000003, 3.45, 3.455, 
 3.46, 3.465, 3.47, 3.475, 3.48, 3.485, 3.49, 3.495, 3.5, 3.505, 
 3.5100000000000002, 3.515, 3.52, 3.525, 3.5300000000000002, 3.535, 3.54, 
 3.545, 3.5500000000000003, 3.555, 3.56};
	
		static double ran[] = {0, 0.005641848820031551, 0.01128341555584962, 0.01692441816555141, 
 0.022564574691844943, 0.02820360330432802, 0.03384122234173543, 
 0.03947715035414402, 0.04511110614512475, 0.050742808813831614, 
 0.05637197779701663, 0.06199833291096047, 0.06762159439330845, 
 0.07324148294480139, 0.07885771977089076, 0.08447002662322806, 
 0.09007812584101815, 0.09568174039222602, 0.10128059391462689, 
 0.10687441075668996, 0.1124629160182849, 0.11804583559120181, 
 0.12362289619947432, 0.12919382543949595, 0.13475835181992007, 
 0.14031620480133383, 0.14586711483569575, 0.15141081340552845, 
 0.15694703306285585, 0.16247550746787656, 0.1679959714273635, 
 0.17350816093278018, 0.1790118131981057, 0.18450666669735818, 
 0.18999246120180882, 0.19546893781687655, 0.20093583901869577, 
 0.2063929086903483, 0.2118398921577497, 0.21727653622518453, 
 0.22270258921047847, 0.22811780097980344, 0.2335219229821036, 
 0.23891470828313788, 0.24429591159912867, 0.24966528933001098, 
 0.2550225995922732, 0.2603676022513832, 0.26570005895379206, 
 0.2710197331585085, 0.27632639016823696, 0.281619797160073, 
 0.2868997232157492, 0.29216593935142465, 0.2974182185470128, 
 0.3026563357750408, 0.30788006802903406, 0.31308919435142113, 
 0.3182834958609523, 0.32346275577962763, 0.32862675945912745, 
 0.3337752944067413, 0.33890815031079025, 0.3440251190655377, 
 0.34912599479558276, 0.3542105738797345, 0.359278654974359, 
 0.3643300390361991, 0.3693645293446587, 0.37438193152355215, 
 0.3793820535623104, 0.3843647058366452, 0.3893297011286642, 
 0.3942768546464356, 0.39920598404299923, 0.4041169094348223, 
 0.40900945341969414, 0.4138834410940607, 0.41873870006979613, 
 0.42357506049040666, 0.42839235504666856, 0.43319041899169625, 
 0.43796909015543967, 0.4427282089586086, 0.4474676184260253, 
 0.4521871641994016, 0.4568866945495403, 0.4615660603879626, 
 0.46622511527795757, 0.47086371544505523, 0.4754817197869237, 
 0.4800789898826893, 0.4846553900016797, 0.4892107871115914, 
 0.4937450508860821, 0.4982580537117876, 0.502749670694765, 
 0.5072197796663633, 0.5116682611885232, 0.5160949985585042, 
 0.5204998778130466, 0.5248827877319636, 0.5292436198411704, 
 0.5335822684151493, 0.5378986304788544, 0.5421926058090581, 
 0.5464640969351418, 0.5507130091393323, 0.5549392504563904, 
 0.5591427316727489, 0.563323366325109, 0.5674810706984946, 
 0.5716157638237684, 0.5757273674746157, 0.5798158061639962, 
 0.5838810071400697, 0.5879229003816007, 0.5919414185928427, 
 0.5959364971979085, 0.5999080743346327, 0.6038560908479259, 
 0.6077804902826307, 0.6116812188758802, 0.6155582255489664, 
 0.6194114618987213, 0.6232408821884179, 0.6270464433381957, 
 0.6308281049150138, 0.6345858291221413, 0.6383195807881863, 
 0.6420293273556719, 0.6457150388691635, 0.6493766879629543, 
 0.6530142498483136, 0.6566277023003051, 0.660217025644181, 
 0.663782202741358, 0.66732321897498, 0.6708400622350779, 0.6743327229033278, 
 0.6778011938374184, 0.6812454703550319, 0.6846655502174444, 
 0.6880614336127553, 0.6914331231387512, 0.694780623785408, 
 0.6981039429170445, 0.7014030902541285, 0.7046780778547458, 
 0.7079289200957377, 0.7111556336535152, 0.7143582374845556, 
 0.7175367528055909, 0.7206912030734918, 0.7238216139648592, 
 0.726928013355326, 0.7300104312985789, 0.7330689000051083, 
 0.7361034538206912, 0.7391141292046166, 0.7421009647076606, 
 0.745064000949816, 0.7480032805977896, 0.7509188483422676, 
 0.7538107508749625, 0.7566790368654455, 0.759523756937773, 
 0.7623449636469155, 0.7651427114549945, 0.7679170567073369, 
 0.7706680576083526, 0.7733957741972444, 0.7761002683235567, 
 0.7787816036225702, 0.7814398454905507, 0.7840750610598597, 
 0.7866873191739325, 0.7892766903621339, 0.7918432468144954, 
 0.7943870623563447, 0.7969082124228322, 0.7994067740333629, 
 0.8018828257659413, 0.8043364477314341, 0.8067677215477618, 
 0.8091767303140226, 0.8115635585845578, 0.8139282923429643, 
 0.8162710189760625, 0.8185918272478258, 0.820890807273278, 
 0.8231680504923666, 0.8254236496438183, 0.8276576987389815, 
 0.8298702930356671, 0.8320615290119876, 0.8342315043402079, 
 0.8363803178606082, 0.8385080695553698, 0.8406148605224872, 
 0.8427007929497149, 0.8447659700885524, 0.8468104962282768, 
 0.8488344766700264, 0.850838017700942, 0.8528212265683723, 
 0.8547842114541484, 0.856727081448933, 0.8586499465266515, 
 0.8605529175190086, 0.8624361060900967, 0.864299624711101, 
 0.8661435866351082, 0.8679681058720208, 0.8697732971635866, 
 0.8715592759585439, 0.8733261583878896, 0.8750740612402759, 
 0.8768031019375383, 0.8785133985103606, 0.8802050695740817, 
 0.8818782343046484, 0.883533012414718, 0.8851695241299166, 
 0.8867878901652546, 0.8883882317017078, 0.8899706703629624, 
 0.8915353281923333, 0.8930823276298567, 0.8946117914895599, 
 0.896123842936915, 0.897618605466477, 0.899096202879712, 0.9005567592630169, 
 0.9020003989659356, 0.9034272465795742, 0.9048374269152168, 
 0.9062310649831488, 0.9076082859716851, 0.9089692152264108, 
 0.9103139782296353, 0.9116427005800606, 0.9129555079726694, 
 0.9142525261788339, 0.9155338810266468, 0.9167996983814787, 
 0.9180501041267614, 0.9192852241450025, 0.9205051842990297, 
 0.9217101104134691, 0.9229001282564582, 0.9240753635215959, 
 0.9252359418101295, 0.926381988613383, 0.9275136292954247, 
 0.9286309890759787, 0.9297341930135782, 0.9308233659889649, 
 0.9318986326887336, 0.9329601175892225, 0.9340079449406524, 
 0.9350422387515133, 0.9360631227731995, 0.9370707204848957, 
 0.9380651550787114, 0.9390465494450669, 0.9400150261583302, 
 0.940970707462704, 0.9419137152583653, 0.9428441710878559, 
 0.943762196122724, 0.9446679111504185, 0.9455614365614331, 
 0.946442892336703, 0.947312398035252, 0.9481700727820903, 
 0.9490160352563626, 0.9498504036797457, 0.9506732958050965, 
 0.9514848289053469, 0.9522851197626488, 0.9530742846577646, 
 0.9538524393597054, 0.9546196991156147, 0.9553761786408962, 
 0.9561219921095863, 0.9568572531449688, 0.957582074810432, 
 0.9582965696005648, 0.9590008494324942, 0.9596950256374592, 
 0.9603792089526229, 0.9610535095131181, 0.9617180368443293, 
 0.9623728998544058, 0.9630182068270052, 0.9636540654142689, 
 0.9642805826300224, 0.9648978648432042, 0.9655060177715187, 
 0.9661051464753108, 0.9666953553516631, 0.9672767481287117, 
 0.967849427860179, 0.9684134969201231, 0.9689690569978996, 
 0.9695162090933357, 0.970055053512114, 0.9705856898613637, 
 0.9711082170454577, 0.9716227332620125, 0.9721293359980904, 
 0.9726281220266002, 0.9731191874028954, 0.9736026274615671, 
 0.9740785368134297, 0.9745470093426969, 0.975008138204346, 
 0.9754620158216677, 0.9759087338840001, 0.976348383344644, 
 0.9767810544189557, 0.9772068365826186, 0.9776258185700871, 
 0.9780380883732035, 0.9784437332399837, 0.9788428396735701, 
 0.9792354934313495, 0.979621779524232, 0.9800017822160911, 
 0.9803755850233603, 0.980743270714784, 0.9811049213113221, 
 0.9814606180862033, 0.9818104415651265, 0.9821544715266071, 
 0.9824927870024648, 0.9828254662784535, 0.9831525868950262, 
 0.9834742256482369, 0.9837904585907745, 0.9841013610331261, 
 0.9844070075448683, 0.9847074719560851, 0.9850028273589058, 
 0.985293146109165, 0.9855784998281805, 0.9858589594046452, 
 0.9861345949966329, 0.9864054760337148, 0.9866716712191824, 
 0.9869332485323788, 0.9871902752311301, 0.9874428178542802, 
 0.9876909422243223, 0.987934713450128, 0.9881741959297683, 
 0.9884094533534282, 0.9886405487064082, 0.9888675442722141, 
 0.9890905016357308, 0.9893094816864775, 0.9895245446219444, 
 0.9897357499510054, 0.9899431564974076, 0.9901468224033327, 
 0.9903468051330306, 0.9905431614765211, 0.9907359475533626, 
 0.9909252188164851, 0.9911110300560857, 0.9912934354035847, 
 0.9914724883356396, 0.9916482416782147, 0.9918207476107067, 
 0.9919900576701199, 0.9921562227552937, 0.9923192931311766, 
 0.992479318433148, 0.9926363476713823, 0.9927904292352575, 
 0.9929416108978023, 0.9930899398201835, 0.9932354625562286, 
 0.9933782250569848, 0.99351827267531, 0.9936556501704964, 
 0.9937904017129221, 0.9939225708887325, 0.9940522007045468, 
 0.9941793335921891, 0.9943040114134433, 0.9944262754648279, 
 0.9945461664823924, 0.99466372464653, 0.994778989586808, 0.9948920003868136, 
 0.9950027955890117, 0.995111413199617, 0.9952178906934749, 
 0.9953222650189527, 0.995424572602839, 0.9955248493552482, 
 0.9956231306745318, 0.995719451452192, 0.9958138460777998, 
 0.995906348443912, 0.9959969919509908, 0.9960858095123195, 
 0.9961728335589188, 0.9962580960444569, 0.9963416284501565, 
 0.996423461789696, 0.9965036266141024, 0.9965821530166384, 
 0.9966590706376786, 0.9967344086695764, 0.9968081958615204, 
 0.9968804605243777, 0.9969512305355255, 0.997020533343667, 
 0.9970883959736351, 0.9971548450311778, 0.997219906707729, 
 0.9972836067851606, 0.9973459706405177, 0.9974070232507334, 
 0.997466789197325, 0.9975252926710697, 0.9975825574766577, 
 0.9976386070373253, 0.9976934643994643, 0.9977471522372077, 
 0.9977996928569931, 0.9978511082021002, 0.9979014198571633, 
 0.9979506490526588, 0.9979988166693662, 0.9980459432428015, 
 0.9980920489676246, 0.9981371537020182, 0.9981812769720377, 
 0.9982244379759344, 0.9982666555884468, 0.9983079483650648, 
 0.9983483345462618, 0.9983878320616982, 0.9984264585343925, 
 0.9984642312848625, 0.9985011673352341, 0.9985372834133188, 
 0.9985725959566593, 0.9986071211165418, 0.9986408747619766, 
 0.9986738724836454, 0.9987061295978151, 0.998737661150219, 
 0.9987684819199034, 0.9987986064230412, 0.9988280489167112, 
 0.9988568234026434, 0.9988849436309295, 0.9989124231037001, 
 0.9989392750787655, 0.998965512573224, 0.9989911483670336, 
 0.9990161950065498, 0.9990406648080282, 0.9990645698610919, 
 0.9990879220321647, 0.9991107329678676, 0.9991330140983816, 
 0.9991547766407751, 0.9991760316022955, 0.9991967897836264, 
 0.9992170617821089, 0.9992368579949287, 0.9992561886222674, 
 0.9992750636704192, 0.9992934929548721, 0.999311486103355, 
 0.9993290525588489, 0.9993462015825646, 0.9993629422568847, 
 0.9993792834882711, 0.9993952340101387, 0.9994108023856942, 
 0.9994259970107409, 0.9994408261164486, 0.9994552977720913, 
 0.999469419887749, 0.9994832002169771, 0.999496646359442, 
 0.9995097657635229, 0.9995225657288812, 0.9995350534089956, 
 0.9995472358136659, 0.9995591198114829, 0.9995707121322661, 
 0.9995820193694696, 0.999593047982555, 0.9996038042993337, 
 0.9996142945182758, 0.9996245247107888, 0.9996345008234653, 
 0.9996442286802978, 0.9996537139848648, 0.9996629623224854, 
 0.9996719791623431, 0.9996807698595799, 0.9996893396573608, 
 0.9996976936889085, 0.9997058369795081, 0.9997137744484831, 
 0.9997215109111428, 0.9997290510807003, 0.9997363995701628, 
 0.999743560894193, 0.9997505394709432, 0.9997573396238616, 
 0.9997639655834707, 0.9997704214891195, 0.9997767113907082, 
 0.9997828392503861, 0.9997888089442238, 0.9997946242638588, 
 0.9998002889181156, 0.9998058065345999, 0.9998111806612685, 
 0.9998164147679721, 0.999821512247976, 0.9998264764194544, 
 0.9998313105269613, 0.9998360177428772, 0.9998406011688324, 
 0.9998450638371066, 0.9998494087120056, 0.999853638691215, 
 0.9998577566071316, 0.9998617652281719, 0.9998656672600594, 
 0.9998694653470892, 0.9998731620733717, 0.9998767599640548, 
 0.9998802614865254, 0.9998836690515897, 0.9998869850146334, 
 0.9998902116767617, 0.9998933512859194, 0.9998964060379906, 
 0.9998993780778803, 0.9999022695005759, 0.9999050823521899, 
 0.9999078186309839, 0.9999104802883753, 0.9999130692299236, 
 0.9999155873163016, 0.9999180363642464, 0.9999204181474947, 
 0.9999227343977002, 0.9999249868053346, 0.999927177020571, 
 0.9999293066541523, 0.9999313772782419, 0.9999333904272599, 
 0.9999353475987022, 0.9999372502539452, 0.999939099819035, 
 0.999940897685461, 0.9999426452109156, 0.9999443437200386, 
 0.999945994505148, 0.9999475988269556, 0.9999491579152702, 
 0.9999506729696856, 0.9999521451602562, 0.9999535756281589, 
 0.9999549654863421, 0.9999563158201618, 0.9999576276880048, 
 0.9999589021219005, 0.9999601401281194, 0.9999613426877595, 
 0.9999625107573223, 0.9999636452692755, 0.9999647471326053, 
 0.9999658172333573, 0.999966856435166, 0.999967865579774, 
 0.9999688454875397, 0.9999697969579359, 0.9999707207700361, 
 0.9999716176829931, 0.9999724884365052, 0.9999733337512747, 
 0.9999741543294554, 0.9999749508550908, 0.9999757239945445, 
 0.9999764743969194, 0.9999772026944693, 0.9999779095030014, 
 0.9999785954222703, 0.9999792610363629, 0.9999799069140761, 
 0.9999805336092856, 0.9999811416613065, 0.9999817315952467, 
 0.9999823039223525, 0.999982859140346, 0.9999833977337558, 
 0.9999839201742399, 0.9999844269209018, 0.9999849184206001, 
 0.9999853951082494, 0.9999858574071167, 0.9999863057291097, 
 0.9999867404750594, 0.9999871620349958, 0.9999875707884177, 
 0.9999879671045563, 0.9999883513426328, 0.9999887238521104, 
 0.9999890849729398, 0.9999894350358002, 0.9999897743623337, 
 0.9999901032653747, 0.9999904220491745, 0.9999907310096199, 
 0.9999910304344467, 0.9999913206034495, 0.9999916017886847, 
 0.9999918742546706, 0.999992138258581, 0.9999923940504358, 
 0.9999926418732864, 0.9999928819633963, 0.9999931145504183, 
 0.9999933398575668, 0.9999935581017861, 0.9999937694939154, 
 0.9999939742388483, 0.9999941725356898, 0.9999943645779092, 
 0.9999945505534893, 0.999994730645071, 0.9999949050300962, 
 0.9999950738809457, 0.9999952373650741, 0.9999953956451422, 
 0.9999955488791448, 0.9999956972205363, 0.999995840818353, 
 0.999995979817332, 0.9999961143580278, 0.9999962445769252, 
 0.9999963706065498, 0.9999964925755764, 0.9999966106089333, 
 0.9999967248279045, 0.9999968353502302, 0.9999969422902035, 
 0.9999970457587656, 0.9999971458635974, 0.9999972427092106, 
 0.9999973363970344, 0.9999974270255015, 0.9999975146901312, 
 0.9999975994836108, 0.9999976814958739, 0.9999977608141782, 
 0.9999978375231799, 0.9999979117050072, 0.9999979834393308, 
 0.9999980528034337, 0.9999981198722784, 0.9999981847185726, 
 0.9999982474128332, 0.9999983080234484, 0.9999983666167385, 
 0.9999984232570148, 0.9999984780066371, 0.9999985309260694, 
 0.9999985820739345, 0.9999986315070669, 0.9999986792805643, 
 0.9999987254478377, 0.9999987700606605, 0.9999988131692154, 
 0.999998854822141, 0.9999988950665768, 0.9999989339482065, 
 0.999998971511301, 0.9999990077987595, 0.9999990428521495, 
 0.9999990767117464, 0.9999991094165713, 0.9999991410044279, 
 0.9999991715119386, 0.9999992009745795, 0.9999992294267144, 
 0.9999992569016276, 0.9999992834315565, 0.9999993090477225, 
 0.9999993337803613, 0.9999993576587528, 0.9999993807112494, 
 0.999999402965304, 0.9999994244474971, 0.9999994451835634, 
 0.9999994651984168, 0.9999994845161754, 0.9999995031601862, 
 0.9999995211530479};
 		for (i=0;i<N;i++)
		{
			if ((posx>dom[i]) && (posx<=dom[i+1]))
			{
				m = (ran[i+1]-ran[i])/(dom[i+1]-dom[i]);
				posval = m*(posx-dom[i])+ran[i];
			}
		}
	}
	
	if ((fS>0) && (x>=0))
		val = posval;
	else if ((fS>0) && (x<0))
		val = -posval;
	else if (fS<0)
		val = 1.0-posval;
		
	return val;
}

double ErrorFunc::DFunction(double x) const
{
	cout << "\n Derivative of the Bessel Function of the 3rd Kind not tabulated!\n";
	return 0.0*x;
}

double ErrorFunc::DDFunction(double x) const
{
	cout << "\n Second derivative of the Bessel Function of the 3rd Kind not tabulated!\n";
	return 0.0*x;
}

/*
* Returning values in groups - derived classes should define
* their own non-virtual function called within this functon
* which maps in to out w/o requiring a virtual function call
* everytime. Default behavior is just to map the virtual functions
* above.
*/
dArrayT& ErrorFunc::MapFunction(const dArrayT& in,  dArrayT& out) const
{
	/* dimension checks */
	if (in.Length() != out.Length()) throw eGeneralFail;
	
	double hi=3.56, val=0.0, m;
	int j, N=713;
	
	double* pl = in.Pointer();
	double* pU = out.Pointer();
	
	for (int i = 0; i < in.Length(); i++)
	{
		double r = *pl++;	
		
		if (r>hi)
			val = 1.0;
		else if ((r>=0) && (r<=hi))
		{
			static double dom[] = {0, 0.005, 0.01, 0.015, 0.02, 0.025, 0.03, 0.035, 0.04, 0.045, 0.05, 0.055, 
 0.06, 0.065, 0.07, 0.075, 0.08, 0.085, 0.09, 0.095, 0.1, 0.105, 0.11, 0.115, 
 0.12, 0.125, 0.13, 0.135, 0.14, 0.145, 0.15, 0.155, 0.16, 0.165, 0.17, 
 0.17500000000000002, 0.18, 0.185, 0.19, 0.195, 0.2, 0.20500000000000002, 
 0.21, 0.215, 0.22, 0.225, 0.23, 0.23500000000000001, 0.24, 0.245, 0.25, 
 0.255, 0.26, 0.265, 0.27, 0.275, 0.28, 0.28500000000000003, 0.29, 0.295, 
 0.3, 0.305, 0.31, 0.315, 0.32, 0.325, 0.33, 0.335, 0.34, 
 0.34500000000000003, 0.35000000000000003, 0.355, 0.36, 0.365, 0.37, 0.375, 
 0.38, 0.385, 0.39, 0.395, 0.4, 0.405, 0.41000000000000003, 
 0.41500000000000004, 0.42, 0.425, 0.43, 0.435, 0.44, 0.445, 0.45, 0.455, 
 0.46, 0.465, 0.47000000000000003, 0.47500000000000003, 0.48, 0.485, 0.49, 
 0.495, 0.5, 0.505, 0.51, 0.515, 0.52, 0.525, 0.53, 0.535, 0.54, 0.545, 0.55, 
 0.555, 0.56, 0.5650000000000001, 0.5700000000000001, 0.5750000000000001, 
 0.58, 0.585, 0.59, 0.595, 0.6, 0.605, 0.61, 0.615, 0.62, 0.625, 0.63, 0.635, 
 0.64, 0.645, 0.65, 0.655, 0.66, 0.665, 0.67, 0.675, 0.68, 0.685, 
 0.6900000000000001, 0.6950000000000001, 0.7000000000000001, 0.705, 0.71, 
 0.715, 0.72, 0.725, 0.73, 0.735, 0.74, 0.745, 0.75, 0.755, 0.76, 0.765, 
 0.77, 0.775, 0.78, 0.785, 0.79, 0.795, 0.8, 0.805, 0.81, 0.8150000000000001, 
 0.8200000000000001, 0.8250000000000001, 0.8300000000000001, 0.835, 0.84, 
 0.845, 0.85, 0.855, 0.86, 0.865, 0.87, 0.875, 0.88, 0.885, 0.89, 0.895, 0.9, 
 0.905, 0.91, 0.915, 0.92, 0.925, 0.93, 0.935, 0.9400000000000001, 
 0.9450000000000001, 0.9500000000000001, 0.9550000000000001, 0.96, 0.965, 
 0.97, 0.975, 0.98, 0.985, 0.99, 0.995, 1., 1.0050000000000001, 1.01, 
 1.0150000000000001, 1.02, 1.025, 1.03, 1.035, 1.04, 1.045, 1.05, 1.055, 
 1.06, 1.065, 1.07, 1.075, 1.08, 1.085, 1.09, 1.095, 1.1, 1.105, 1.11, 1.115, 
 1.12, 1.125, 1.1300000000000001, 1.135, 1.1400000000000001, 1.145, 
 1.1500000000000001, 1.155, 1.16, 1.165, 1.17, 1.175, 1.18, 1.185, 1.19, 
 1.195, 1.2, 1.205, 1.21, 1.215, 1.22, 1.225, 1.23, 1.235, 1.24, 1.245, 1.25, 
 1.2550000000000001, 1.26, 1.2650000000000001, 1.27, 1.2750000000000001, 
 1.28, 1.285, 1.29, 1.295, 1.3, 1.305, 1.31, 1.315, 1.32, 1.325, 1.33, 1.335, 
 1.34, 1.345, 1.35, 1.355, 1.36, 1.365, 1.37, 1.375, 1.3800000000000001, 
 1.385, 1.3900000000000001, 1.395, 1.4000000000000001, 1.405, 1.41, 1.415, 
 1.42, 1.425, 1.43, 1.435, 1.44, 1.445, 1.45, 1.455, 1.46, 1.465, 1.47, 
 1.475, 1.48, 1.485, 1.49, 1.495, 1.5, 1.5050000000000001, 1.51, 
 1.5150000000000001, 1.52, 1.5250000000000001, 1.53, 1.5350000000000001, 
 1.54, 1.545, 1.55, 1.555, 1.56, 1.565, 1.57, 1.575, 1.58, 1.585, 1.59, 
 1.595, 1.6, 1.605, 1.61, 1.615, 1.62, 1.625, 1.6300000000000001, 1.635, 
 1.6400000000000001, 1.645, 1.6500000000000001, 1.655, 1.6600000000000001, 
 1.665, 1.67, 1.675, 1.68, 1.685, 1.69, 1.695, 1.7, 1.705, 1.71, 1.715, 1.72, 
 1.725, 1.73, 1.735, 1.74, 1.745, 1.75, 1.7550000000000001, 1.76, 
 1.7650000000000001, 1.77, 1.7750000000000001, 1.78, 1.7850000000000001, 
 1.79, 1.795, 1.8, 1.805, 1.81, 1.815, 1.82, 1.825, 1.83, 1.835, 1.84, 1.845, 
 1.85, 1.855, 1.86, 1.865, 1.87, 1.875, 1.8800000000000001, 1.885, 
 1.8900000000000001, 1.895, 1.9000000000000001, 1.905, 1.9100000000000001, 
 1.915, 1.92, 1.925, 1.93, 1.935, 1.94, 1.945, 1.95, 1.955, 1.96, 1.965, 
 1.97, 1.975, 1.98, 1.985, 1.99, 1.995, 2., 2.005, 2.0100000000000002, 2.015, 
 2.02, 2.025, 2.0300000000000002, 2.035, 2.04, 2.045, 2.05, 2.055, 2.06, 
 2.065, 2.07, 2.075, 2.08, 2.085, 2.09, 2.095, 2.1, 2.105, 2.11, 2.115, 2.12, 
 2.125, 2.13, 2.1350000000000002, 2.14, 2.145, 2.15, 2.1550000000000002, 
 2.16, 2.165, 2.17, 2.1750000000000003, 2.18, 2.185, 2.19, 2.195, 2.2, 2.205, 
 2.21, 2.215, 2.22, 2.225, 2.23, 2.235, 2.24, 2.245, 2.25, 2.255, 
 2.2600000000000002, 2.265, 2.27, 2.275, 2.2800000000000002, 2.285, 2.29, 
 2.295, 2.3000000000000003, 2.305, 2.31, 2.315, 2.32, 2.325, 2.33, 2.335, 
 2.34, 2.345, 2.35, 2.355, 2.36, 2.365, 2.37, 2.375, 2.38, 
 2.3850000000000002, 2.39, 2.395, 2.4, 2.4050000000000002, 2.41, 2.415, 2.42, 
 2.4250000000000003, 2.43, 2.435, 2.44, 2.445, 2.45, 2.455, 2.46, 2.465, 
 2.47, 2.475, 2.48, 2.485, 2.49, 2.495, 2.5, 2.505, 2.5100000000000002, 
 2.515, 2.52, 2.525, 2.5300000000000002, 2.535, 2.54, 2.545, 
 2.5500000000000003, 2.555, 2.56, 2.565, 2.57, 2.575, 2.58, 2.585, 2.59, 
 2.595, 2.6, 2.605, 2.61, 2.615, 2.62, 2.625, 2.63, 2.6350000000000002, 2.64, 
 2.645, 2.65, 2.6550000000000002, 2.66, 2.665, 2.67, 2.6750000000000003, 
 2.68, 2.685, 2.69, 2.695, 2.7, 2.705, 2.71, 2.715, 2.72, 2.725, 2.73, 2.735, 
 2.74, 2.745, 2.75, 2.755, 2.7600000000000002, 2.765, 2.77, 2.775, 
 2.7800000000000002, 2.785, 2.79, 2.795, 2.8000000000000003, 2.805, 2.81, 
 2.815, 2.82, 2.825, 2.83, 2.835, 2.84, 2.845, 2.85, 2.855, 2.86, 2.865, 
 2.87, 2.875, 2.88, 2.8850000000000002, 2.89, 2.895, 2.9, 2.9050000000000002, 
 2.91, 2.915, 2.92, 2.9250000000000003, 2.93, 2.935, 2.94, 2.945, 2.95, 
 2.955, 2.96, 2.965, 2.97, 2.975, 2.98, 2.985, 2.99, 2.995, 3., 3.005, 
 3.0100000000000002, 3.015, 3.02, 3.025, 3.0300000000000002, 3.035, 3.04, 
 3.045, 3.0500000000000003, 3.055, 3.06, 3.065, 3.0700000000000003, 3.075, 
 3.08, 3.085, 3.09, 3.095, 3.1, 3.105, 3.11, 3.115, 3.12, 3.125, 3.13, 
 3.1350000000000002, 3.14, 3.145, 3.15, 3.1550000000000002, 3.16, 3.165, 
 3.17, 3.1750000000000003, 3.18, 3.185, 3.19, 3.1950000000000003, 3.2, 3.205, 
 3.21, 3.215, 3.22, 3.225, 3.23, 3.235, 3.24, 3.245, 3.25, 3.255, 
 3.2600000000000002, 3.265, 3.27, 3.275, 3.2800000000000002, 3.285, 3.29, 
 3.295, 3.3000000000000003, 3.305, 3.31, 3.315, 3.3200000000000003, 3.325, 
 3.33, 3.335, 3.34, 3.345, 3.35, 3.355, 3.36, 3.365, 3.37, 3.375, 3.38, 
 3.3850000000000002, 3.39, 3.395, 3.4, 3.4050000000000002, 3.41, 3.415, 3.42, 
 3.4250000000000003, 3.43, 3.435, 3.44, 3.4450000000000003, 3.45, 3.455, 
 3.46, 3.465, 3.47, 3.475, 3.48, 3.485, 3.49, 3.495, 3.5, 3.505, 
 3.5100000000000002, 3.515, 3.52, 3.525, 3.5300000000000002, 3.535, 3.54, 
 3.545, 3.5500000000000003, 3.555, 3.56};
	
			static double ran[] = {0, 0.005641848820031551, 0.01128341555584962, 0.01692441816555141, 
 0.022564574691844943, 0.02820360330432802, 0.03384122234173543, 
 0.03947715035414402, 0.04511110614512475, 0.050742808813831614, 
 0.05637197779701663, 0.06199833291096047, 0.06762159439330845, 
 0.07324148294480139, 0.07885771977089076, 0.08447002662322806, 
 0.09007812584101815, 0.09568174039222602, 0.10128059391462689, 
 0.10687441075668996, 0.1124629160182849, 0.11804583559120181, 
 0.12362289619947432, 0.12919382543949595, 0.13475835181992007, 
 0.14031620480133383, 0.14586711483569575, 0.15141081340552845, 
 0.15694703306285585, 0.16247550746787656, 0.1679959714273635, 
 0.17350816093278018, 0.1790118131981057, 0.18450666669735818, 
 0.18999246120180882, 0.19546893781687655, 0.20093583901869577, 
 0.2063929086903483, 0.2118398921577497, 0.21727653622518453, 
 0.22270258921047847, 0.22811780097980344, 0.2335219229821036, 
 0.23891470828313788, 0.24429591159912867, 0.24966528933001098, 
 0.2550225995922732, 0.2603676022513832, 0.26570005895379206, 
 0.2710197331585085, 0.27632639016823696, 0.281619797160073, 
 0.2868997232157492, 0.29216593935142465, 0.2974182185470128, 
 0.3026563357750408, 0.30788006802903406, 0.31308919435142113, 
 0.3182834958609523, 0.32346275577962763, 0.32862675945912745, 
 0.3337752944067413, 0.33890815031079025, 0.3440251190655377, 
 0.34912599479558276, 0.3542105738797345, 0.359278654974359, 
 0.3643300390361991, 0.3693645293446587, 0.37438193152355215, 
 0.3793820535623104, 0.3843647058366452, 0.3893297011286642, 
 0.3942768546464356, 0.39920598404299923, 0.4041169094348223, 
 0.40900945341969414, 0.4138834410940607, 0.41873870006979613, 
 0.42357506049040666, 0.42839235504666856, 0.43319041899169625, 
 0.43796909015543967, 0.4427282089586086, 0.4474676184260253, 
 0.4521871641994016, 0.4568866945495403, 0.4615660603879626, 
 0.46622511527795757, 0.47086371544505523, 0.4754817197869237, 
 0.4800789898826893, 0.4846553900016797, 0.4892107871115914, 
 0.4937450508860821, 0.4982580537117876, 0.502749670694765, 
 0.5072197796663633, 0.5116682611885232, 0.5160949985585042, 
 0.5204998778130466, 0.5248827877319636, 0.5292436198411704, 
 0.5335822684151493, 0.5378986304788544, 0.5421926058090581, 
 0.5464640969351418, 0.5507130091393323, 0.5549392504563904, 
 0.5591427316727489, 0.563323366325109, 0.5674810706984946, 
 0.5716157638237684, 0.5757273674746157, 0.5798158061639962, 
 0.5838810071400697, 0.5879229003816007, 0.5919414185928427, 
 0.5959364971979085, 0.5999080743346327, 0.6038560908479259, 
 0.6077804902826307, 0.6116812188758802, 0.6155582255489664, 
 0.6194114618987213, 0.6232408821884179, 0.6270464433381957, 
 0.6308281049150138, 0.6345858291221413, 0.6383195807881863, 
 0.6420293273556719, 0.6457150388691635, 0.6493766879629543, 
 0.6530142498483136, 0.6566277023003051, 0.660217025644181, 
 0.663782202741358, 0.66732321897498, 0.6708400622350779, 0.6743327229033278, 
 0.6778011938374184, 0.6812454703550319, 0.6846655502174444, 
 0.6880614336127553, 0.6914331231387512, 0.694780623785408, 
 0.6981039429170445, 0.7014030902541285, 0.7046780778547458, 
 0.7079289200957377, 0.7111556336535152, 0.7143582374845556, 
 0.7175367528055909, 0.7206912030734918, 0.7238216139648592, 
 0.726928013355326, 0.7300104312985789, 0.7330689000051083, 
 0.7361034538206912, 0.7391141292046166, 0.7421009647076606, 
 0.745064000949816, 0.7480032805977896, 0.7509188483422676, 
 0.7538107508749625, 0.7566790368654455, 0.759523756937773, 
 0.7623449636469155, 0.7651427114549945, 0.7679170567073369, 
 0.7706680576083526, 0.7733957741972444, 0.7761002683235567, 
 0.7787816036225702, 0.7814398454905507, 0.7840750610598597, 
 0.7866873191739325, 0.7892766903621339, 0.7918432468144954, 
 0.7943870623563447, 0.7969082124228322, 0.7994067740333629, 
 0.8018828257659413, 0.8043364477314341, 0.8067677215477618, 
 0.8091767303140226, 0.8115635585845578, 0.8139282923429643, 
 0.8162710189760625, 0.8185918272478258, 0.820890807273278, 
 0.8231680504923666, 0.8254236496438183, 0.8276576987389815, 
 0.8298702930356671, 0.8320615290119876, 0.8342315043402079, 
 0.8363803178606082, 0.8385080695553698, 0.8406148605224872, 
 0.8427007929497149, 0.8447659700885524, 0.8468104962282768, 
 0.8488344766700264, 0.850838017700942, 0.8528212265683723, 
 0.8547842114541484, 0.856727081448933, 0.8586499465266515, 
 0.8605529175190086, 0.8624361060900967, 0.864299624711101, 
 0.8661435866351082, 0.8679681058720208, 0.8697732971635866, 
 0.8715592759585439, 0.8733261583878896, 0.8750740612402759, 
 0.8768031019375383, 0.8785133985103606, 0.8802050695740817, 
 0.8818782343046484, 0.883533012414718, 0.8851695241299166, 
 0.8867878901652546, 0.8883882317017078, 0.8899706703629624, 
 0.8915353281923333, 0.8930823276298567, 0.8946117914895599, 
 0.896123842936915, 0.897618605466477, 0.899096202879712, 0.9005567592630169, 
 0.9020003989659356, 0.9034272465795742, 0.9048374269152168, 
 0.9062310649831488, 0.9076082859716851, 0.9089692152264108, 
 0.9103139782296353, 0.9116427005800606, 0.9129555079726694, 
 0.9142525261788339, 0.9155338810266468, 0.9167996983814787, 
 0.9180501041267614, 0.9192852241450025, 0.9205051842990297, 
 0.9217101104134691, 0.9229001282564582, 0.9240753635215959, 
 0.9252359418101295, 0.926381988613383, 0.9275136292954247, 
 0.9286309890759787, 0.9297341930135782, 0.9308233659889649, 
 0.9318986326887336, 0.9329601175892225, 0.9340079449406524, 
 0.9350422387515133, 0.9360631227731995, 0.9370707204848957, 
 0.9380651550787114, 0.9390465494450669, 0.9400150261583302, 
 0.940970707462704, 0.9419137152583653, 0.9428441710878559, 
 0.943762196122724, 0.9446679111504185, 0.9455614365614331, 
 0.946442892336703, 0.947312398035252, 0.9481700727820903, 
 0.9490160352563626, 0.9498504036797457, 0.9506732958050965, 
 0.9514848289053469, 0.9522851197626488, 0.9530742846577646, 
 0.9538524393597054, 0.9546196991156147, 0.9553761786408962, 
 0.9561219921095863, 0.9568572531449688, 0.957582074810432, 
 0.9582965696005648, 0.9590008494324942, 0.9596950256374592, 
 0.9603792089526229, 0.9610535095131181, 0.9617180368443293, 
 0.9623728998544058, 0.9630182068270052, 0.9636540654142689, 
 0.9642805826300224, 0.9648978648432042, 0.9655060177715187, 
 0.9661051464753108, 0.9666953553516631, 0.9672767481287117, 
 0.967849427860179, 0.9684134969201231, 0.9689690569978996, 
 0.9695162090933357, 0.970055053512114, 0.9705856898613637, 
 0.9711082170454577, 0.9716227332620125, 0.9721293359980904, 
 0.9726281220266002, 0.9731191874028954, 0.9736026274615671, 
 0.9740785368134297, 0.9745470093426969, 0.975008138204346, 
 0.9754620158216677, 0.9759087338840001, 0.976348383344644, 
 0.9767810544189557, 0.9772068365826186, 0.9776258185700871, 
 0.9780380883732035, 0.9784437332399837, 0.9788428396735701, 
 0.9792354934313495, 0.979621779524232, 0.9800017822160911, 
 0.9803755850233603, 0.980743270714784, 0.9811049213113221, 
 0.9814606180862033, 0.9818104415651265, 0.9821544715266071, 
 0.9824927870024648, 0.9828254662784535, 0.9831525868950262, 
 0.9834742256482369, 0.9837904585907745, 0.9841013610331261, 
 0.9844070075448683, 0.9847074719560851, 0.9850028273589058, 
 0.985293146109165, 0.9855784998281805, 0.9858589594046452, 
 0.9861345949966329, 0.9864054760337148, 0.9866716712191824, 
 0.9869332485323788, 0.9871902752311301, 0.9874428178542802, 
 0.9876909422243223, 0.987934713450128, 0.9881741959297683, 
 0.9884094533534282, 0.9886405487064082, 0.9888675442722141, 
 0.9890905016357308, 0.9893094816864775, 0.9895245446219444, 
 0.9897357499510054, 0.9899431564974076, 0.9901468224033327, 
 0.9903468051330306, 0.9905431614765211, 0.9907359475533626, 
 0.9909252188164851, 0.9911110300560857, 0.9912934354035847, 
 0.9914724883356396, 0.9916482416782147, 0.9918207476107067, 
 0.9919900576701199, 0.9921562227552937, 0.9923192931311766, 
 0.992479318433148, 0.9926363476713823, 0.9927904292352575, 
 0.9929416108978023, 0.9930899398201835, 0.9932354625562286, 
 0.9933782250569848, 0.99351827267531, 0.9936556501704964, 
 0.9937904017129221, 0.9939225708887325, 0.9940522007045468, 
 0.9941793335921891, 0.9943040114134433, 0.9944262754648279, 
 0.9945461664823924, 0.99466372464653, 0.994778989586808, 0.9948920003868136, 
 0.9950027955890117, 0.995111413199617, 0.9952178906934749, 
 0.9953222650189527, 0.995424572602839, 0.9955248493552482, 
 0.9956231306745318, 0.995719451452192, 0.9958138460777998, 
 0.995906348443912, 0.9959969919509908, 0.9960858095123195, 
 0.9961728335589188, 0.9962580960444569, 0.9963416284501565, 
 0.996423461789696, 0.9965036266141024, 0.9965821530166384, 
 0.9966590706376786, 0.9967344086695764, 0.9968081958615204, 
 0.9968804605243777, 0.9969512305355255, 0.997020533343667, 
 0.9970883959736351, 0.9971548450311778, 0.997219906707729, 
 0.9972836067851606, 0.9973459706405177, 0.9974070232507334, 
 0.997466789197325, 0.9975252926710697, 0.9975825574766577, 
 0.9976386070373253, 0.9976934643994643, 0.9977471522372077, 
 0.9977996928569931, 0.9978511082021002, 0.9979014198571633, 
 0.9979506490526588, 0.9979988166693662, 0.9980459432428015, 
 0.9980920489676246, 0.9981371537020182, 0.9981812769720377, 
 0.9982244379759344, 0.9982666555884468, 0.9983079483650648, 
 0.9983483345462618, 0.9983878320616982, 0.9984264585343925, 
 0.9984642312848625, 0.9985011673352341, 0.9985372834133188, 
 0.9985725959566593, 0.9986071211165418, 0.9986408747619766, 
 0.9986738724836454, 0.9987061295978151, 0.998737661150219, 
 0.9987684819199034, 0.9987986064230412, 0.9988280489167112, 
 0.9988568234026434, 0.9988849436309295, 0.9989124231037001, 
 0.9989392750787655, 0.998965512573224, 0.9989911483670336, 
 0.9990161950065498, 0.9990406648080282, 0.9990645698610919, 
 0.9990879220321647, 0.9991107329678676, 0.9991330140983816, 
 0.9991547766407751, 0.9991760316022955, 0.9991967897836264, 
 0.9992170617821089, 0.9992368579949287, 0.9992561886222674, 
 0.9992750636704192, 0.9992934929548721, 0.999311486103355, 
 0.9993290525588489, 0.9993462015825646, 0.9993629422568847, 
 0.9993792834882711, 0.9993952340101387, 0.9994108023856942, 
 0.9994259970107409, 0.9994408261164486, 0.9994552977720913, 
 0.999469419887749, 0.9994832002169771, 0.999496646359442, 
 0.9995097657635229, 0.9995225657288812, 0.9995350534089956, 
 0.9995472358136659, 0.9995591198114829, 0.9995707121322661, 
 0.9995820193694696, 0.999593047982555, 0.9996038042993337, 
 0.9996142945182758, 0.9996245247107888, 0.9996345008234653, 
 0.9996442286802978, 0.9996537139848648, 0.9996629623224854, 
 0.9996719791623431, 0.9996807698595799, 0.9996893396573608, 
 0.9996976936889085, 0.9997058369795081, 0.9997137744484831, 
 0.9997215109111428, 0.9997290510807003, 0.9997363995701628, 
 0.999743560894193, 0.9997505394709432, 0.9997573396238616, 
 0.9997639655834707, 0.9997704214891195, 0.9997767113907082, 
 0.9997828392503861, 0.9997888089442238, 0.9997946242638588, 
 0.9998002889181156, 0.9998058065345999, 0.9998111806612685, 
 0.9998164147679721, 0.999821512247976, 0.9998264764194544, 
 0.9998313105269613, 0.9998360177428772, 0.9998406011688324, 
 0.9998450638371066, 0.9998494087120056, 0.999853638691215, 
 0.9998577566071316, 0.9998617652281719, 0.9998656672600594, 
 0.9998694653470892, 0.9998731620733717, 0.9998767599640548, 
 0.9998802614865254, 0.9998836690515897, 0.9998869850146334, 
 0.9998902116767617, 0.9998933512859194, 0.9998964060379906, 
 0.9998993780778803, 0.9999022695005759, 0.9999050823521899, 
 0.9999078186309839, 0.9999104802883753, 0.9999130692299236, 
 0.9999155873163016, 0.9999180363642464, 0.9999204181474947, 
 0.9999227343977002, 0.9999249868053346, 0.999927177020571, 
 0.9999293066541523, 0.9999313772782419, 0.9999333904272599, 
 0.9999353475987022, 0.9999372502539452, 0.999939099819035, 
 0.999940897685461, 0.9999426452109156, 0.9999443437200386, 
 0.999945994505148, 0.9999475988269556, 0.9999491579152702, 
 0.9999506729696856, 0.9999521451602562, 0.9999535756281589, 
 0.9999549654863421, 0.9999563158201618, 0.9999576276880048, 
 0.9999589021219005, 0.9999601401281194, 0.9999613426877595, 
 0.9999625107573223, 0.9999636452692755, 0.9999647471326053, 
 0.9999658172333573, 0.999966856435166, 0.999967865579774, 
 0.9999688454875397, 0.9999697969579359, 0.9999707207700361, 
 0.9999716176829931, 0.9999724884365052, 0.9999733337512747, 
 0.9999741543294554, 0.9999749508550908, 0.9999757239945445, 
 0.9999764743969194, 0.9999772026944693, 0.9999779095030014, 
 0.9999785954222703, 0.9999792610363629, 0.9999799069140761, 
 0.9999805336092856, 0.9999811416613065, 0.9999817315952467, 
 0.9999823039223525, 0.999982859140346, 0.9999833977337558, 
 0.9999839201742399, 0.9999844269209018, 0.9999849184206001, 
 0.9999853951082494, 0.9999858574071167, 0.9999863057291097, 
 0.9999867404750594, 0.9999871620349958, 0.9999875707884177, 
 0.9999879671045563, 0.9999883513426328, 0.9999887238521104, 
 0.9999890849729398, 0.9999894350358002, 0.9999897743623337, 
 0.9999901032653747, 0.9999904220491745, 0.9999907310096199, 
 0.9999910304344467, 0.9999913206034495, 0.9999916017886847, 
 0.9999918742546706, 0.999992138258581, 0.9999923940504358, 
 0.9999926418732864, 0.9999928819633963, 0.9999931145504183, 
 0.9999933398575668, 0.9999935581017861, 0.9999937694939154, 
 0.9999939742388483, 0.9999941725356898, 0.9999943645779092, 
 0.9999945505534893, 0.999994730645071, 0.9999949050300962, 
 0.9999950738809457, 0.9999952373650741, 0.9999953956451422, 
 0.9999955488791448, 0.9999956972205363, 0.999995840818353, 
 0.999995979817332, 0.9999961143580278, 0.9999962445769252, 
 0.9999963706065498, 0.9999964925755764, 0.9999966106089333, 
 0.9999967248279045, 0.9999968353502302, 0.9999969422902035, 
 0.9999970457587656, 0.9999971458635974, 0.9999972427092106, 
 0.9999973363970344, 0.9999974270255015, 0.9999975146901312, 
 0.9999975994836108, 0.9999976814958739, 0.9999977608141782, 
 0.9999978375231799, 0.9999979117050072, 0.9999979834393308, 
 0.9999980528034337, 0.9999981198722784, 0.9999981847185726, 
 0.9999982474128332, 0.9999983080234484, 0.9999983666167385, 
 0.9999984232570148, 0.9999984780066371, 0.9999985309260694, 
 0.9999985820739345, 0.9999986315070669, 0.9999986792805643, 
 0.9999987254478377, 0.9999987700606605, 0.9999988131692154, 
 0.999998854822141, 0.9999988950665768, 0.9999989339482065, 
 0.999998971511301, 0.9999990077987595, 0.9999990428521495, 
 0.9999990767117464, 0.9999991094165713, 0.9999991410044279, 
 0.9999991715119386, 0.9999992009745795, 0.9999992294267144, 
 0.9999992569016276, 0.9999992834315565, 0.9999993090477225, 
 0.9999993337803613, 0.9999993576587528, 0.9999993807112494, 
 0.999999402965304, 0.9999994244474971, 0.9999994451835634, 
 0.9999994651984168, 0.9999994845161754, 0.9999995031601862, 
 0.9999995211530479};
	 		for (j=0;j<N;j++)
			{
				if ((r>dom[j]) && (r<=dom[j+1]))
				{
					m = (ran[j+1]-ran[j])/(dom[j+1]-dom[j]);
					val = m*(r-dom[j])+ran[j];
				}
			}
		}
		else if (r<0)
			val = ErrorFunc::Function(r);		
		
		*pU++ = val;
	}
	return out;
}

dArrayT& ErrorFunc::MapDFunction(const dArrayT& in,  dArrayT& out) const
{
	/* dimension checks */
	if (in.Length() != out.Length()) throw eGeneralFail;

	double* pl  = in.Pointer();
	double* pdU = out.Pointer();
	
	cout << "\n Derivative of the Bessel Function of the 3rd Kind not tabulated!\n";
	for (int i = 0; i < in.Length(); i++)
	{
		double r = *pl++;					
		*pdU++ = 0.0;
	}
	return out;
}

dArrayT& ErrorFunc::MapDDFunction(const dArrayT& in,  dArrayT& out) const
{
	/* dimension checks */
	if (in.Length() != out.Length()) throw eGeneralFail;

	double* pl   = in.Pointer();
	double* pddU = out.Pointer();
	
	cout << "\n Second derivative of the Bessel Function of the 3rd Kind not tabulated!\n";
	for (int i = 0; i < in.Length(); i++)
	{
		double r = *pl++;				
		*pddU++ = 0.0;
	}
	return out;
}


