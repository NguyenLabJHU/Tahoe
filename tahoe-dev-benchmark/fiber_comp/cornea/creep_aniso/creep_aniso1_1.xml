<?xml version="1.0" encoding="UTF-8"?>
<tahoe author="tdnguye" geometry_file="../geometry/cube_8.exo"
    geometry_format="ExodusII" output_format="ExodusII"
    restart_file="creep_aniso1_0.rs500of500" restart_output_inc="500"
    title="fiber_comp_test" xmlns:x0="http://www.w3.org/2001/XMLSchema">
    <time max_step_cuts="4" num_steps="500" output_inc="1" time_step=".5">
        <schedule_function>
            <piecewise_linear>
                <OrderedPair x="0" y="0"/>
                <OrderedPair x=".25" y="1"/>
            </piecewise_linear>
        </schedule_function>
    </time>
    <nodes>
        <field field_name="displacement">
            <dof_labels>
                <String value="D_X"/>
                <String value="D_Y"/>
                <String value="D_Z"/>
            </dof_labels>
            <kinematic_BC dof="1" node_ID="2" type="fixed"/>
            <kinematic_BC dof="2" node_ID="6" type="fixed"/>
        </field>
        <history_node_ID_list>
            <String value="5"/>
        </history_node_ID_list>
    </nodes>
    <element_list>
        <uplag_fiber_comp_planar field_name="displacement">
            <hexahedron num_ip="8"/>
            <natural_bc coordinate_system="global" schedule="1" side_set_ID="2">
                <DoubleList>
                    <Double value="0.0"/>
                    <Double value="500"/>
                    <Double value="0.0"/>
                </DoubleList>
            </natural_bc>
            <solid_element_nodal_output coordinates="1"
                displacements="1" material_output="1" stress="1"/>
            <fiber_comp_element_block>
                <block_ID_list>
                    <String value="1"/>
                </block_ID_list>
                <fiber_comp_material>
                    <aniso_viscoelastic_cornea density="1.0" n_points="11">
                        <matrix_material_params>
                            <Neo-Hookean bulk_modulus="30.0" shear_modulus="10.0"/>
                        </matrix_material_params>
                        <eq_fibril_potential>
                            <fung_type alpha="0.121" beta="34.7" description="f(I) = alpha*(exp(beta*(I - 1.0)) + beta/I)"/>
                        </eq_fibril_potential>
                        <neq_fibril_potential>
                            <fung_type alpha="0.234" beta="34.7"/>
                        </neq_fibril_potential>
                        <neq_fibril_potential>
                            <fung_type alpha="0.242" beta="34.7"/>
                        </neq_fibril_potential>
                        <neq_fibril_potential>
                            <fung_type alpha="0.6" beta="34.7"/>
                        </neq_fibril_potential>
                       <viscosity>
                            <scaled_csch
                                description="f(tau) = eta0* tau/tau0 / Sinh(tau/tau0)"
                                eta0="4.5555e+3" tau0="20000"/>
                        </viscosity>
                        <viscosity>
                            <scaled_csch
                                description="f(tau) = eta0* tau/tau0 / Sinh(tau/tau0)"
                                eta0="9.1111e+4" tau0="20000"/>
                        </viscosity>
                        <viscosity>
                            <scaled_csch
                                description="f(tau) = eta0* tau/tau0 / Sinh(tau/tau0)"
                                eta0="9.1111e+7" tau0="450"/>
                        </viscosity>
                        <fibril_distribution>
                            <power_trig a="1.0" b="1.0" c="0.454" n="8" phi="0.0"/>
                        </fibril_distribution>
                    </aniso_viscoelastic_cornea>
                </fiber_comp_material>
            </fiber_comp_element_block>
            <fiber_orientations>
                <side_set coordinate_system="local" side_set_ID="1">
                    <DoubleList name="NT">
                        <Double value="1.0"/>
                        <Double value="0.0"/>
                        <Double value="0.0"/>
                    </DoubleList>
                    <DoubleList name="IS">
                        <Double value="0.0"/>
                        <Double value="1.0"/>
                        <Double value="0.0"/>
                    </DoubleList>
                </side_set>
            </fiber_orientations>
        </uplag_fiber_comp_planar>
    </element_list>
    <nonlinear_solver abs_tolerance="1e-8" divergence_tolerance="100"
        max_iterations="10" rel_tolerance="1e-10">
        <profile_matrix/>
    </nonlinear_solver>
</tahoe>
