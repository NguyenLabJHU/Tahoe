<?xml version="1.0" encoding="UTF-8"?>
<tahoe author="tdnguye" geometry_file="../geometry/tube_quarter_test3.exo"
    geometry_format="ExodusII" output_format="ExodusII"
    restart_file="tube1.rs10of10" restart_output_inc="1000"
    title="fiber_comp_test" xmlns:x0="http://www.w3.org/2001/XMLSchema">
    <graph_decomposition/>
    <time max_step_cuts="6" num_steps="4000" output_inc="2" time_step=".02">
        <schedule_function>
            <cosine a="1" b="1" c="1" d="-1.4707963" description="f(x) = a + b cos(c t + d)"/>
        </schedule_function>
    </time>
    <nodes>
        <field field_name="displacement">
            <dof_labels>
                <String value="D_X"/>
                <String value="D_Y"/>
                <String value="D_Z"/>
            </dof_labels>
            <kinematic_BC dof="2" node_ID="1" type="fixed"/>
            <kinematic_BC dof="2" node_ID="2" type="fixed"/>
            <kinematic_BC dof="3" node_ID="4" type="fixed"/>
            <kinematic_BC dof="1" node_ID="3" type="fixed"/>
            <pressure_bc control="pressure" schedule="1" schedule_scale=".1">
                <side_set_ID_list>
                    <String value="3"/>
                </side_set_ID_list>
            </pressure_bc>
        </field>
    </nodes>
    <element_list>
        <uplag_fiber_comp_planar field_name="displacement">
            <hexahedron num_ip="8"/>
            <solid_element_nodal_output coordinates="1"
                displacements="1" material_output="1" 
		 principal_stress="1" stress="1"/>
            <fiber_comp_element_block>
                <block_ID_list>
                    <String value="2"/>
                </block_ID_list>
                <fiber_comp_material>
                    <fiberI4_viscoelastic density="1">
                        <eq_matrix_potential>
                            <mooney-rivlin c1=".1" c2="0" kappa="1000"/>
                        </eq_matrix_potential>
                        <neq_matrix_potential>
                            <mooney-rivlin c1=".1" c2="0" kappa="0"/>
                        </neq_matrix_potential>
                        <matrix_visc_potential>
                            <linear_exponential a=".1" b="0" c="0" d="1"/>
                        </matrix_visc_potential>
                        <eq_fiber_2fib_pot>
                            <parabola b="0"
                                description="f(x) = 0.5*k*(x-l0)^2 - 0.5*k*b"
                                k="20" l0="1.0"/>
                        </eq_fiber_2fib_pot>
                        <neq_fiber_2fib_pot>
                            <parabola b="0"
                                description="f(x) = 0.5*k*(x-l0)^2 - 0.5*k*b"
                                k="20" l0="1.0"/>
                        </neq_fiber_2fib_pot>
                        <fiber_visc_potential>
                            <linear_exponential a="40" b="0" c="0" d="1"/>
                        </fiber_visc_potential>
                    </fiberI4_viscoelastic>
                </fiber_comp_material>
            </fiber_comp_element_block>
            <fiber_comp_element_block>
                <block_ID_list>
                    <String value="1"/>
                </block_ID_list>
                <fiber_comp_material>
                    <fiberI4_viscoelastic density="1">
                        <eq_matrix_potential>
                            <mooney-rivlin c1=".1" c2="0" kappa="1000"/>
                        </eq_matrix_potential>
                        <neq_matrix_potential>
                            <mooney-rivlin c1=".1" c2="0" kappa="0"/>
                        </neq_matrix_potential>
                        <matrix_visc_potential>
                            <linear_exponential a=".1" b="0" c="0" d="1"/>
                        </matrix_visc_potential>
                        <eq_fiber_2fib_pot>
                            <parabola b="0"
                                description="f(x) = 0.5*k*(x-l0)^2 - 0.5*k*b"
                                k="20" l0="1.0"/>
                        </eq_fiber_2fib_pot>
                        <neq_fiber_2fib_pot>
                            <parabola b="0"
                                description="f(x) = 0.5*k*(x-l0)^2 - 0.5*k*b"
                                k="20" l0="1.0"/>
                        </neq_fiber_2fib_pot>
                        <fiber_visc_potential>
                            <linear_exponential a="40" b="0" c="0" d="1"/>
                        </fiber_visc_potential>
                    </fiberI4_viscoelastic>
                </fiber_comp_material>
            </fiber_comp_element_block>
            <fiber_orientations>
                <side_set coordinate_system="local" side_set_ID="1">
                    <DoubleList name="P1">
                        <Double value="0.766044443118978"/>
                        <Double value="0.6427876096865394"/>
                        <Double value="0.0"/>
                    </DoubleList>
                    <DoubleList name="P2">
                        <Double value="-0.766044443118978"/>
                        <Double value="0.6427876096865394"/>
                        <Double value="0.0"/>
                    </DoubleList>
                </side_set>
            </fiber_orientations>
            <fiber_orientations>
                <side_set coordinate_system="local" side_set_ID="2">
                    <DoubleList name="P1">
                        <Double value="0.984807753012208"/>
                        <Double value="0.1736481776669304"/>
                        <Double value="0.0"/>
                    </DoubleList>
                    <DoubleList name="P2">
                        <Double value="-0.984807753012208"/>
                        <Double value="0.1736481776669304"/>
                        <Double value="0.0"/>
                    </DoubleList>
                </side_set>
            </fiber_orientations>
        </uplag_fiber_comp_planar>
    </element_list>
    <nonlinear_solver abs_tolerance="1e-10" divergence_tolerance="100"
        max_iterations="6" rel_tolerance="1e-8">
        <SPOOLES_matrix/>
    </nonlinear_solver>
</tahoe>
