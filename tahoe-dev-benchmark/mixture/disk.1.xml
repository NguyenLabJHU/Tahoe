<?xml version="1.0" encoding="UTF-8"?>
<tahoe author="paklein" geometry_file="./simulations/disk/geometry/disk.exo"
    geometry_format="ExodusII" output_format="ExodusII"
    title="contracting fiber" xmlns:x0="http://www.w3.org/2001/XMLSchema">
    <time max_step_cuts="10" num_steps="10" output_inc="1" time_step="0.001">
        <schedule_function>
            <piecewise_linear>
                <OrderedPair x="0.0" y="0.0"/>
                <OrderedPair x="1.0" y="1.0"/>
            </piecewise_linear>
        </schedule_function>
        <schedule_function>
            <piecewise_linear>
                <OrderedPair x="0.0" y="1.0"/>
                <OrderedPair x="1.0" y="0.0"/>
            </piecewise_linear>
        </schedule_function>
        <schedule_function>
            <power_law a="1.0" b="1.0" c="-1.0" n="2.0"/>
        </schedule_function>
    </time>
    <nodes>
        <field field_name="displacement" solution_group="1">
            <dof_labels>
                <String value="D_X"/>
                <String value="D_Y"/>
                <String value="D_Z"/>
            </dof_labels>
            <kinematic_BC dof="3" node_ID="1"/>
            <kinematic_BC dof="3" node_ID="2"/>
            <mapped_nodes schedule="1">
                <Matrix_3x3 A_1_1="-1.0" A_2_2="-1.0"/>
                <mapped_node_ID_list>
                    <String value="4"/>
                </mapped_node_ID_list>
            </mapped_nodes>
        </field>
        <field field_name="solid" integrator="trapezoid" solution_group="2">
            <dof_labels>
                <String value="c_s"/>
            </dof_labels>
            <kinematic_BC dof="1" node_ID="4" schedule="0" type="u" value="0.5"/>
        </field>
        <field field_name="fluid" integrator="trapezoid" solution_group="3">
            <dof_labels>
                <String value="c_f"/>
            </dof_labels>
            <initial_condition all_nodes="true" dof="1" type="u" value="0.5"/>
            <kinematic_BC dof="1" node_ID="3" schedule="3" type="u" value="0.5"/>
        </field>
    </nodes>
    <element_list>
        <updated_lagrangian_mixture field_name="displacement">
            <hexahedron num_ip="27"/>
            <solid_element_nodal_output displacements="1" material_output="1"/>
            <large_strain_element_block>
                <block_ID_list>
                    <String value="1"/>
                </block_ID_list>
                <large_strain_material_3D>
                    <large_strain_solid_mixture density="1.0">
                        <solid_mixture_species concentration_field="solid">
                            <large_strain_StVenant density="1.0">
                                <E_and_nu Poisson_ratio="0.25" Young_modulus="100.0"/>
                            </large_strain_StVenant>
                        </solid_mixture_species>
                        <solid_mixture_species concentration_field="fluid">
                            <large_strain_StVenant density="1.0">
                                <E_and_nu Poisson_ratio="0.25" Young_modulus="100.0"/>
                            </large_strain_StVenant>
                        </solid_mixture_species>
                    </large_strain_solid_mixture>
                </large_strain_material_3D>
            </large_strain_element_block>
        </updated_lagrangian_mixture>
        <mixture_species field_name="fluid" output_mass="true"
            solid_element_group="1" stress_gradient_option="global_projection">
            <hexahedron num_ip="27"/>
            <diffusion_element_nodal_output displacement="1" material_output="1"/>
            <diffusion_element_block>
                <block_ID_list>
                    <String value="1"/>
                </block_ID_list>
                <diffusion_material>
                    <linear_diffusion_material conductivity="1.0e-01"
                        density="1.0" specific_heat="1.0"/>
                </diffusion_material>
            </diffusion_element_block>
        </mixture_species>
    </element_list>
    <nonlinear_solver abs_tolerance="1.0e-10"
        divergence_tolerance="1.0e+10" max_iterations="10" rel_tolerance="1.0e-12">
        <profile_matrix/>
    </nonlinear_solver>
    <nonlinear_solver abs_tolerance="1.0e-10"
        divergence_tolerance="1.0e+10" max_iterations="10" rel_tolerance="1.0e-12">
        <profile_matrix/>
    </nonlinear_solver>
    <nonlinear_solver_LS abs_tolerance="1.0e-10"
        check_LHS_perturbation="1.0e-08" divergence_tolerance="1.0E+10"
        line_search_iterations="5" line_search_tolerance="0.1"
        max_iterations="100" max_step="2.5E0" rel_tolerance="1.0e-06">
        <profile_matrix/>
    </nonlinear_solver_LS>
    <solver_phases max_loops="100">
        <solver_phase iterations="-1" pass_iterations="0" solver="1"/>
        <solver_phase iterations="-1" pass_iterations="0" solver="2"/>
        <solver_phase iterations="-1" pass_iterations="0" solver="3"/>
    </solver_phases>
</tahoe>
